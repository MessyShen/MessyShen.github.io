# 网络安全

### 信息载体的安全

* 攻击
  * 物理侵犯	
  * 系统漏洞
  * 网络入侵
  * 恶意软件
* 安全措施
  * 防火墙 防病毒软件 入侵检测
  * 漏洞扫描 存储备份 安全审计
  * 事故响应

### 信息自身的安全

* 攻击
  * 非法访问
  * 数据篡改
  * 信息漏洞
  * 否认
* 安全措施
  * 身份鉴别
  * 访问控制
  * 数据加密
  * 完整性验证
  * 数字签名
  * 内容过滤

### 计算机安全的核心内容和目标

* 机密性
* 完整性
* 可用性
* 真实性
* 可回溯性（要求任何实体的行为均可以被惟一地追踪到）

# 安全攻击

### 被动攻击

对传输的数据进行窃听或监视。

### 主动攻击

篡改（消息重放）

伪装 

拒绝服务攻击



# 一次一密

优点:由于使用与消息等长的随机密钥, 产生与原文没有任何统计关系的随机输出,因此一次一密方案不可破解。

缺陷:密钥在传递和分发上存在很大困难。



# 网络安全模型

（根据安全实施的位置）

加密安全模型：用户消息经网络进行传输，需要由安全系统对传输的消息进行保护。

访问安全模型：攻击者也有可能试图通过网络对系统资源进行访问，此时需要对资源系统提供安全保护。



# 密码体制

根据在加密解密过程中使用的加密密钥和解密密钥是否相同将密码体制分为

* 对称密码体制
* 非对称密码体制

根据密文数据段是否与明文数据段在整个明文中的位置有关，可以将密码体制分为

* 分组密码体制
* 序列密码体制

根据加密变换是否可逆将密码体制分为

* 单向函数密码体制
* 双向变换密码体制

根据在加密过程中是否引入客观随机因素将加密体制分为

* 确定型密码体制
* 概率密码体制



# Shannon的理论

### 理想密码

密文的所有统计特征都是独立于密钥的。

### 扩散

让明文和密钥的每个字母影响尽可能多的密文字母的取值，从而使得明文和密钥的统计特征被扩散。

### 扰乱

使密文的统计特征和明文和加密密钥的关系尽可能复杂。



# Feistel

### 输入

长度为2w比特的明文分组和密钥K。

### 加密

```
LE0 = (P)LW; 
RE0 = (P)RW; 
for i = 1 step 1 to n do
	LEi = REi-1; 
	REi = LEi-1 ⊕ F(REi-1, Ki)
end for
LEn+1 = REn; 
REn+1 = LEn; 
C = LEn+1 || REn+1; 
```

### 解密

```
LD0 = (C)LW; 
RD0 = (C)RW; 
for i = 1 step 1 to n do
	LDi = RDi-1; 
	RDi = LDi-1 ⊕ F(RDi-1, Kn-i+1) //解密算法在n轮循环时使用子密钥的顺序与加密时相反
end for
LDn+1 = RDn; 
RDn+1 = LDn; 
P = LDn+1 || RDn+1;
```

### 参数

分组长度64bit。

密钥长度128bit或更长的密钥长度。

循环次数16次。



# 分组密码的操作模式

### 本质

用于增强密码算法或者使算法适应具体应用的技术。

### 分类

* 电子密码本（ECB）
* 密文分组链接（CBC）
* 密文反馈（CFB）
* 输出反馈（OFB）
* 计数器（CTR）

### 电子密码本模式ECB

相同的密钥对每个明文分组进行加密。

明文的加密过程与密文无关。可以并行加密。

**仅适合于**：加密传输少量的数据信息，例如用于传输密钥。

**缺陷**：重复模式问题。

### 密文分组链接CBC

加密：

​	对**当前明文分**组与**前一密文分组**的**异或操作结果**进行加密。

​	引入一个初始向量IV与第一个明文分组进行异或。

​	IV应该与密钥一样受到保护。

解密：

​	对称进行。

重复模式问题不会暴露。

适用于：

​	**大量信息**和**高结构化信息**的加密传输。（实现了明文模式的隐藏）

​	提供机密性，认证。

### 密文反馈CFB

将任意分组密码转换为流密码。本质：利用分组加密模块来产生密钥流。

流密码：无需填充，实时操作。

通常每次处理8bit。移位寄存器64bit，初始化为IV。

加密：

​	加密函数输出结果的最左边（最高位）h比特与h比特的明文P1进行异或操作，以生成h比特密文C1；然后移位寄存器左移h位，并将密文C1移入移位寄存器的最右边（最低位）h比特中；重复以上过程直至所有的明文都完成加密。

解密过程与加密过程相同。

只要保证发送方与接收方移位寄存器中初始向量IV的值相等，就能保证移位寄存器MS与MR相等。

**缺点：**

* 与明文异或的比特流是与密文相关的。
* 若传输中密文出错，则会造成解密错误。一个密文单元出错，会造成连续w/h个解密明文的错误。

### 输出反馈OFB

**优点**：

​	传输中的比特差错不会传播。

**缺点**:

​	比CFB模式更容易受到报文流篡改攻击。

### 计数器模式CTR

使用了与明文分组等长的计数器。

在加密不同的明文分组时该计数器的值必须是不同的。

**优点**：

* 无需对明文进行填充。
* 初始计数器的值必须是时变的。
* 传输中的比特差错不会传播。

**应用**：IPSec的加密处理

# DES 

Data Encryption Standard

### 输入

明文分组和密钥。

### 参数

| item               | Length           |
| ------------------ | ---------------- |
| 明文分组长度       | 64 bit           |
| 密钥长度           | 56 bit（输入64） |
| 每轮循环子密钥长度 | 48 bit           |
| 循环轮数           | 16               |

### 加密阶段

明文：

初始置换IP。

Feistel密码循环。

逆初始置换IP-1。

### 特点

雪崩效应。雪崩效应越强，待搜索的明文和密钥空间越大。

### 弱点

在穷举攻击下相对比较脆弱。

# S-DES

### 输入

8比特明文和10比特密钥。

### 输出

8比特密文。

解密算法与加密算法相同，但以相反的次序使用子密钥。

# 双重DES

利用两个不同的密钥对明文进行两次连续的加密处理。

DES使用的密钥长度为两个密钥之和，共112位。

### 弱点

双重DES算法易受中途攻击（Meet-in-the-Middle Attack）。



# 三重DES

使用了三个不同的密钥，密钥长度为168比特。

# AES

| item         | Length                  |
| ------------ | ----------------------- |
| 明文分组长度 | 128 bit                 |
| 密钥长度     | 128 bit 192 bit 256 bit |
| AES-128      | 密钥4，循环10           |
| AES-192      | 密钥6，循环12           |
| AES-256      | 密钥8，循环14           |

AES加密和解密过程中，仅在加轮密钥变换中使用了扩展密钥。

AES算法的每个面向字节的变换均可逆。

AES解密算法与加密算法具有相似的结构，解密算法以与加密算法相反的次序使用扩展密钥。

#### 四变换

* 字节替代
* 移行 
* 混列（有限域GF(2^8)上的算术特性执行替代。） 
* 加轮密钥

# RC5

| item       | Length               |
| ---------- | -------------------- |
| 字长w      | 16/ 32/ 64bit        |
| 循环轮数r  | [0…255]，常用16      |
| 密钥长度b  | [0…255]，常用16 字节 |
| 分组长度2w | 32/64/128            |
|            |                      |

选择合适的循环轮数和密钥长度需要在安全性和计算速度之间进行均衡考虑。

简单、加密速度快、便于软件和硬件实现。



# SM4

| item         | Length   |
| ------------ | -------- |
| 分组长度     | 128 bit  |
| 密钥长度b    | 128 bit  |
| 加密运算单位 | 32 bit字 |
| 迭代         | 32轮     |
|              |          |

加密/解密算法具有相同的结构，只是轮密钥的使用顺序相反，解密过程以与加密过程相反的次序使用轮密钥。



# 非对称密码体制

### 要解决的两个问题

密钥分配

数字签名

### 特点

* 基于数学函数。不基于替代和置换。
* 密钥是非对称的，它使用两个不同的密钥。
* 解决了身份鉴别和数字签名问题。
* 使密钥管理变得容易。
* 比对称慢。

### 安全性（和对称密码相比？）

安全程度都依赖于密钥的长度和破译密码所需要的工作量。

### 是否能取代对称密码？

非对称计算上的开销巨大。仅限于密钥管理和数字签名等应用。

### 特性

仅仅知道密码算法和公钥而要确定私钥，在计算上是不可行的；

两个相关密钥中任何一个都可以用作加密，而让另外一个用作解密。

### 基本原理

加密/解密时，发送方使用**<u>接收方的公钥</u>**加密消息，而接收方使用**<u>自己的私钥</u>**解密消息；

数字签名时，发送方使用<u>**自己的私钥**</u>加密消息，而接收方使用**<u>发送方的公钥</u>**来解密消息，验证签名。

### 攻击

针对机密性：

通过已知信息恢复M和$KR_B$。

针对数字签名/认证：

计算发送方私钥估计值。

### 应用范围

|                | 加密解密 | 数字签名 | 密钥交换 |
| -------------- | -------- | -------- | -------- |
| RSA            | √        | √        | √        |
| Diffie-Hellman |          |          | √        |
| ELGamal        | √        | √        |          |
| DSA            |          | √        |          |
| 椭圆曲线       | √        | √        | √        |

### 长度

对称密码 < ECC < RSA

# RSA

### 算法步骤

1. 选择两个大的素数 p, q。p != q;
2. n = p*q;
3. φ(n)=(p-1)(q-1)
4. 找到e, gcd⁡(φ(n),e)=1。
5. 计算d，ed=1 mod φ(n)。
6. 公钥为KU={e, n}。
7. 私钥为KR={d, n}。

加密 $C=M^e \mod n$

解密 $M=C^d  \mod n$

### 安全性

RSA算法的安全性是基于大整数因子分解的困难性

# Diffie-Hellman

### 安全性

在有限域上计算离散对数的困难性。

未对通信双方的身份进行鉴别，容易受到中间人攻击，可以采用数字签名与公钥证书来防止攻击的发生。

# Elgamal

### 安全性

依赖于计算有限域上离散对数的难度。

# 椭圆曲线

求椭圆曲线上的离散对数，在计算上是不可行的。

### 特点

* 安全性好
* 所需密钥长度短
* 灵活性好



# 安全散列函数

### 用途

消息认证

数字签名

### 报文认证

报文认证是用来验证消息完整性的安全服务或安全机制，报文认证确保报文来自可信的源点且在传输过程中未被篡改。

### 数字签名

是一种防止源点或终点抵赖的技术。

### 首要目标

保证数据的完整性。

# MD5

### 本质

将大容量信息在数字签名前“压缩”成一种保密的格式。

### 参数

| item         | length            |
| ------------ | ----------------- |
| 报文分组长度 | 512 bit           |
| 报文摘要长度 | 128 bit           |
| 长度信息     | 64 bit            |
| MD缓存       | 128 bit (4*32bit) |
| 循环 * 步骤  | 4 * 16            |
|              |                   |

### 压缩函数

$a\leftarrow b + CLS_s(a+g(b,c,d)+X[k]+T[i])$

意义：使产生碰撞非常困难。



# SHA

Secure Hash Algorithm

安全散列演算法

### 参数(SHA-512为例)

| item             | length              |
| ---------------- | ------------------- |
| SHA-1 散列值长度 | 160 bit             |
| SHA-2 散列值长度 | 256 / 384 / 512 bit |
| 长度信息         | 64 bit              |
| MD缓存           | 128 bit (4*32bit)   |
| 循环 * 步骤      | 4 * 16              |
| 分组长度         | 1024 bit            |
| H_SHA轮数        | 80轮                |
| 每轮使用的W_t    | 64 bit              |
|                  |                     |

### 压缩函数

$T_1=H+Ch(E,F,G)+\sum_{1}^{512}E+W_t+K_t$

$T_2=\sum_{0}^{512}A+Maj(A,B,C)$

$A = T_1+T_2$

$B=A$

$C=B$

$E=D+T_1$

$F=E$

$G=F$

$H=G$

操作增加了被压缩报文的冗余性和相互依赖型。

# 网络攻击与解决策略

| 攻击       | 策略              |
| ---------- | ----------------- |
| 泄露       | 加密 报文填充     |
| 通信量分析 | 加密 报文填充     |
| 伪装       | 报文认证 数字签名 |
| 内容篡改   | 报文认证 数字签名 |
| 序号篡改   | 报文认证 数字签名 |
| 计时篡改   | 报文认证 数字签名 |
| 抵赖       | 数字签名          |



# 报文认证

验证所受到的报文确实来自真正声称的发送方，且在传输过程中未被修改。

### 报文认证码MAC

不必可逆。



# HMAC



# 数字签名

### 分类

ElGamal

Schnorr

DSS数字签名标准。

### 性质

必须能够验证签名者的身份 以及生成签名的时间。

能够用于证实被签名消息的内容。

数字签名必须能被第三方验证。

### 使用方式

直接数字签名

需仲裁的数字签名

